
trigger:
  - master
  - ci/azp-test

pr:
  - master

jobs:
  - job: Linux- Without bleeding edge packages
    pool:
      vmImage: 'ubuntu-latest'
    strategy:
      matrix:
        Python36:
          python.version: 3.6
        Python37:
          python.version: 3.7

    steps:
      - bash: echo "##vso[task.prependpath]$CONDA/bin"
        displayName: Add Conda to path

      - bash: |
          conda config --set always_yes yes --set changeps1 no
          conda config --add channels omnia
          conda config --add channels janschulz
          conda config --add channels conda-forge
          conda config --add channels mosdef
        displayName: Add relavent Channels

      - bash: conda create -n test-environment python=$(python.version) --file requirements-dev.txt
        displayName: Create Conda env, install dependencies

      - script: python -m pytest -v --nbval --nbval-lax --cov=mbuild --cov-report= --pyargs mbuild
        displayName: Run Tests


